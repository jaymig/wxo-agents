
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../embedded/hello-world-embedded/">
      
      
        <link rel="next" href="../../resources/resources/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.7">
    
    
      
        <title>Chat via API - Watsonx Orchestrate Agents and Tools</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b4a2bd9.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
        html.glightbox-open { overflow: initial; height: 100%; }
        .gslide-title { margin-top: 0px; user-select: text; }
        .gslide-desc { color: #666; user-select: text; }
        .gslide-image img { background: white; }
        
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
            </style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#hello-world-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Watsonx Orchestrate Agents and Tools" class="md-header__button md-logo" aria-label="Watsonx Orchestrate Agents and Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Watsonx Orchestrate Agents and Tools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chat via API
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Watsonx Orchestrate Agents and Tools" class="md-nav__button md-logo" aria-label="Watsonx Orchestrate Agents and Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Watsonx Orchestrate Agents and Tools
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../wxo-agents/hello-world/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hello World Agent
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Agent examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Agent examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../wxo-agents/department-contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Department Contact Agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ADK examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ADK examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../adk/getting-started-adk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started with ADK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../adk/hello-world-adk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hello World Agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Embedded examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Embedded examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../embedded/hello-world-embedded/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Floating panel chat
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Chat via API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Chat via API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authenticating-with-your-tenant" class="md-nav__link">
    Authenticating with your tenant
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-the-agent-via-runs-api" class="md-nav__link">
    Chat with the Agent via /runs API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-the-agent-id" class="md-nav__link">
    Get the Agent ID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#send-a-message-to-the-agent" class="md-nav__link">
    Send a message to the Agent
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-the-messages" class="md-nav__link">
    Get the messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Appendix
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/todo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Article todo list
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authenticating-with-your-tenant" class="md-nav__link">
    Authenticating with your tenant
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chat-with-the-agent-via-runs-api" class="md-nav__link">
    Chat with the Agent via /runs API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-the-agent-id" class="md-nav__link">
    Get the Agent ID
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#send-a-message-to-the-agent" class="md-nav__link">
    Send a message to the Agent
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-the-messages" class="md-nav__link">
    Get the messages
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    Resources
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="hello-world-api">Hello World API</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial ruses the Insomnia HTTP client to interact with the Watsonx Orchestrate APIs.  You can download Insomnia from <a href="https://insomnia.rest/download">the Insomnia web site.</a>.</p>
</div>
<p>Once you have completed your first <a href="../../wxo-agents/hello-world/" target="_blank">Hello World Agent</a>, follow the instructions to interact with your agent using the APIs. This tutorial assumes that you have installed the agent on a SaaS tenant. </p>
<h2 id="objective">Objective</h2>
<p>At the end of this tutorial, you should have sent a message to the agent using the <a href="https://developer.watson-orchestrate.ibm.com/apis/orchestrate-agent/chat-with-orchestrate-assistant">/runs api</a> and viewed the new messages using the <a href="https://developer.watson-orchestrate.ibm.com/apis/message-threads/get-message-by-id">/messages api</a>.  You will see the message detail in the the Insomnia client as well as in your browser.</p>
<h2 id="authenticating-with-your-tenant">Authenticating with your tenant</h2>
<p>The following steps guild you through how to fetch an authentication token required to interact with the APIs.  If this is your first time using Insomnia, I reccomend you create a new Project where we sill create HTTP calls, and also an environment where we will store API keys, and other end point information.</p>
<ol>
<li>
<p>Click on the "+" icon in the upper right hand corner of Insomnia to create a new project, and give the project a name.
<br><br>
<a class="glightbox" href="../../images/insomnia_new_project.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="create project" src="../../images/insomnia_new_project.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
<br><br>
<a class="glightbox" href="../../images/hello_world_insomnia_project.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="new project name" src="../../images/hello_world_insomnia_project.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Create a new Environment by clicking on the "+" icon to the rigth of the Environments label.  Give your new environment a name.
<br><br>
<a class="glightbox" href="../../images/create_new_environment.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="create project" src="../../images/create_new_environment.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
<br><br>
<a class="glightbox" href="../../images/hello_world_demo_environment.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="new project name" src="../../images/hello_world_demo_environment.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Navigate into your enviornment by clicking on it, and then add your first environment variable "auth_url".  The url for generating auth tokens is <a href="https://developer.ibm.com/apis/catalog/watsonorchestrate--custom-assistants/api/API--watsonorchestrate--generating-a-json-web-token#generatingjwt">documented here</a>.
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>https://iam.platform.saas.ibm.com/siusermgr/api/1.0/apikeys/token
</span></code></pre></div>
Your environment should look like this:
<br><br>
<a class="glightbox" href="../../images/auth_url_environment.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="auth url" src="../../images/auth_url_environment.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Next we need to add two more enviornment variables:  API key and tenant URL.  The API key and tenant url can be found in the settings menu of your watsonx Orchstrate tenant.
<br><br>
<a class="glightbox" href="../../images/settings_menu.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="settings menu" src="../../images/settings_menu.png#shadow#left" style="height:300x;width:300px" /></a>
<br><br>
<br><br>
<a class="glightbox" href="../../images/url_and_API_key.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="url and api key" src="../../images/url_and_API_key.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
Here is a view of the configured environment
<br><br>
<a class="glightbox" href="../../images/environment_with_api_key_and_urls.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="configured environment" src="../../images/environment_with_api_key_and_urls.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
You can now exit the enviornment by clicking on the X in the tab, and then open up your collection by clicking on Collection, as shown in the screenshots:
<br><br>
<a class="glightbox" href="../../images/exit_environment.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="exit environment" src="../../images/exit_environment.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
<br><br>
<a class="glightbox" href="../../images/click_on_collections.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="open collections" src="../../images/click_on_collections.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Now we will configure an API call to generate a token.  This API is documented <a href="https://developer.ibm.com/apis/catalog/watsonorchestrate--custom-assistants/api/API--watsonorchestrate--generating-a-json-web-token#generatingjwt">here</a>.  Start by opening up your collection by clicking on it.
<br><br>
<a class="glightbox" href="../../images/open_my_first_collection.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="open my collections" src="../../images/open_my_first_collection.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Select your environment, so the API call can use the variables you just created.  In the top left of Insomnia, click on Global Settings drop down menu and select the "Hello World Demo Environment".
<br><br>
<a class="glightbox" href="../../images/select_hello_world_environment.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="select environment" src="../../images/select_hello_world_environment.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>You should be prompted to create your first HTTP API call.  Since this is a POST, you need to select POST from the drop down list.
<br><br>
<a class="glightbox" href="../../images/configure_http_post.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="select POST" src="../../images/configure_http_post.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Now we will insert the variable for the URL.  By typeing a period "." in the URL box, a list of available variables will appear.  Select the _.auth_url from the list.<br />
<br><br>
<a class="glightbox" href="../../images/insert_auth_url.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="select POST" src="../../images/insert_auth_url.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
Here you can see what the correctly configured URL field should look like.  Note how the preview field below shows the actual URL using the value of the variables
<br><br>
<a class="glightbox" href="../../images/configured_url.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="select POST" src="../../images/configured_url.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Now we will configure the body of the HTTP call to include the API Key. In the body section, type
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>{&quot;apikey&quot;: &quot;&quot;}
</span></code></pre></div>
Then insert a "." for the value of the API key, and a drop down list will appear with the available variables.  Select _.api_key from the list.
<br><br>
<a class="glightbox" href="../../images/configure_api_key.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="configure key" src="../../images/configure_api_key.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
Here you can see what the correctly configured body looks like, with the variable as a placeholder for the value of the API key. 
<br><br>
<a class="glightbox" href="../../images/configured_body.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="configured body" src="../../images/configured_body.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Now you are ready to test.  Click the SEND button. You should see a response payload that includes the token.
<br><br>
<a class="glightbox" href="../../images/send_success.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="send_success" src="../../images/send_success.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>To prevent confusion with other HTTP requests, let's rename this first HTTP call to "Token Auth", by clicking on the settings menu option and updating the name.
<br><br>
<a class="glightbox" href="../../images/rename_to_token_Auth.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="rename token auth" src="../../images/rename_to_token_Auth.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
</ol>
<p>Congratulation!  You are now ready to use the /runs API</p>
<h2 id="chat-with-the-agent-via-runs-api">Chat with the Agent via /runs API</h2>
<p>Now that you have an auth token, we will use that token to authenticate using the /runs api, which will send a message to the agent, and we should see a response from the agent.  </p>
<ol>
<li>
<p>First we need to create a new request.  By closing all the existing tabs, you should see an empty canvas with an icon to create a new HTTP request.
<br><br>
<a class="glightbox" href="../../images/create_new_HTTP_request.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="new HTTP request" src="../../images/create_new_HTTP_request.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Next we can populate the URL using the same technique as we did above, select POST method from the drop down list, and then type a period "." and select _.wxo_url from the list.  Then append this to your host:
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>/v1/orchestrate/runs
</span></code></pre></div>
Here is a view of the completed URL configuration
<br><br>
<a class="glightbox" href="../../images/orchestrate_runs_api_request.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="new HTTP request" src="../../images/orchestrate_runs_api_request.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Navigate to the Auth tab, and select 'Bearer' from the drop down list.
<br><br>
<a class="glightbox" href="../../images/orchestrate_runs_auth.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="select Bearer" src="../../images/orchestrate_runs_auth.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Next we will configure the token from the Token Auth API call as input to our Authorization token.  In the Token field, type a period "." and select "Request -&gt; OAuth 2.0 Access Token" from the list.
<br><br>
<a class="glightbox" href="../../images/orchestrate_runs_auth_config.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="select OAuth token" src="../../images/orchestrate_runs_auth_config.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>The result is an input variable that needs to be configured.  Click on the unconfigured variable token and a configuration dialogue will appear.
<br><br>
<a class="glightbox" href="../../images/unconfigured_token_input.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="unconfigured input" src="../../images/unconfigured_token_input.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
Variable configuration dialogue box:
<br><br>
<a class="glightbox" href="../../images/edit_tag.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="edit tag" src="../../images/edit_tag.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Click on the "function to perform" and select "Response - reference values from other request's responses"
<br><br>
<a class="glightbox" href="../../images/edit_tags_reference_values_from_other_requests.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="reference values" src="../../images/edit_tags_reference_values_from_other_requests.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Under Attribute, select "Body Attribute - value of response body" and under Request select "POST Token Auth"
<br><br>
<a class="glightbox" href="../../images/edit_tag_select_token_auth.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="configure attribute" src="../../images/edit_tag_select_token_auth.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Lastly, configure the filter to fetch the "token" field from the Token Auth output.  This can be done using the syntax 
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a> $.token
</span></code></pre></div>
(which represent the token parameter from the output of the Token Auth API call, payload).  You can see the token value in the 'live Preview" box at the bottom of the screen.
<br><br>
<a class="glightbox" href="../../images/edit_tag_configure_filter.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="configure filter" src="../../images/edit_tag_configure_filter.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
Click Done to complete this configuration.  The correctly configured Auth section should look like this:
<br><br>
<a class="glightbox" href="../../images/runs_api_auth_configured.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="configure filter" src="../../images/runs_api_auth_configured.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Now we need to configure the body section.  Navigate to the body section and end the following text:
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>{
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>&quot;message&quot;:{
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    &quot;role&quot;:&quot;user&quot;,
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    &quot;content&quot;:&quot;Hello, How are you?&quot;
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>   },
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>&quot;agent_id&quot;:&quot;AGENT_ID&quot;
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>}
</span></code></pre></div>
Note how I have a placeholder for the Agent ID.  In the next section, we will configure an HTTP call to fetch the Agent ID.  For now, save this HTTP call under the name "Runs API"</p>
</li>
</ol>
<h2 id="get-the-agent-id">Get the Agent ID</h2>
<p>We need the Agent ID in order to call the /runs API.  In this section we will create an HTTP call to fetch the Agent ID.</p>
<ol>
<li>
<p>Create a new HTTP request, using the "+" icon at the top of your list of existing HTTP requests.  Select "New HTTP request" from the menu
<br><br>
<a class="glightbox" href="../../images/get_agent_id/new_http_request.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="new http request" src="../../images/get_agent_id/new_http_request.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Configure the request with the _.wxo_url variable and the following path:
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>/v1/orchestrate/agents
</span></code></pre></div>
<br><br>
<a class="glightbox" href="../../images/get_agent_id/get_agents_url.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="get agent url" src="../../images/get_agent_id/get_agents_url.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Configure the HTTP request Auth with the bearer token using the identical setup as shown in steps 4 - 8 above.
<br><br>
<a class="glightbox" href="../../images/get_agent_id/get_agents_auth.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="get agent authl" src="../../images/get_agent_id/get_agents_auth.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Click the Send button and view the results, which should be your agent details.  If your tenant has multiple agents, use the CMD+F key to search for 'hello_world' and you should be able to find the Hello World agent and see it's id.
<br><br>
<a class="glightbox" href="../../images/get_agent_id/get_agents_api_call.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="get agent outputl" src="../../images/get_agent_id/get_agents_api_call.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
Copy the Agent ID and save it to your environment.
<br><br>
<a class="glightbox" href="../../images/get_agent_id/environment_with_agent_id.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="environment with agent_idl" src="../../images/get_agent_id/environment_with_agent_id.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
</ol>
<h2 id="send-a-message-to-the-agent">Send a message to the Agent</h2>
<ol>
<li>
<p>Now that we have the Agent ID, we can use it in the /runs API call.  Navigate back to the Runs API configuration screens, select the body tab.  In here you should replace the "AGENT_ID" with a period ".".  In the ensuing drop down list, you should see the new variable for the agent_id.
<br><br>
<a class="glightbox" href="../../images/runs_api/runs_api_body_config.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="runs API body configl" src="../../images/runs_api/runs_api_body_config.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Now you can send your first message to the agent.  Click Send.  If everything is working, you can see the resulting object has a thread_id.
<br><br>
<a class="glightbox" href="../../images/runs_api/runs_api_first_test.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="runs API first testl" src="../../images/runs_api/runs_api_first_test.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br>
Save the thread_id as a new environment varible. We will use it to view the messages in the thread, using the /messages API.
<br><br>
<a class="glightbox" href="../../images/list_messages/environment_with_thread_id.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="environment with thread_idl" src="../../images/list_messages/environment_with_thread_id.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
</ol>
<h2 id="get-the-messages">Get the messages</h2>
<ol>
<li>
<p>Now you have successfully sent a message to the agent, we can view it using the /messages API.   Create a new HTTP request, with the following URL as shown in the diagram.
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>GET {{ _.wxo_url }}/v1/orchestrate/threads/{{ _.thread_id }}/messages
</span></code></pre></div>
<br><br>
<a class="glightbox" href="../../images/list_messages/get_messages_url_config.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="get message URL configl" src="../../images/list_messages/get_messages_url_config.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Follow step 4 - 8 above in the ## section to configure the Auth section with a Bearer token.
<br><br>
<a class="glightbox" href="../../images/list_messages/get_messages_auth_config.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="get message Auth configl" src="../../images/list_messages/get_messages_auth_config.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
<li>
<p>Run the command and view the messages in the thread.  You should be able to see the message you sent and the response from the Agent.
<br><br>
<a class="glightbox" href="../../images/list_messages/get_messages_output.png#shadow#left" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="get message outputl" src="../../images/list_messages/get_messages_output.png#shadow#left" style="height:500x;width:500px" /></a>
<br><br></p>
</li>
</ol>
<h2 id="resources">Resources</h2>
<p>You can find the Insomnia export of [my environment[(../insomnia/Hello-world-demo-environment_2025-08-29.yaml)] (sanitized) and <a href="../../insomnia/my_first_collection.yaml">My first Collection</a>.   </p>
<p>Please provide feedback to jmig@us.ibm.com</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>